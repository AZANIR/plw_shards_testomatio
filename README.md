# Playwright Tests with Testomat.io Reporter and Sharded CI Runs

–ü–æ–≤–Ω–∏–π —Ä–æ–±–æ—á–∏–π –ø—Ä–∏–∫–ª–∞–¥ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Playwright —Ç–µ—Å—Ç—ñ–≤ –∑ Testomat.io —Ä–µ–ø–æ—Ä—Ç–µ—Ä–æ–º —Ç–∞ sharded –∑–∞–ø—É—Å–∫–∞–º–∏ –≤ GitHub Actions.

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
npm install
```

### 2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä—ñ–≤ Playwright

```bash
npx playwright install --with-deps
```

### 3. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Testomat.io

1. –û—Ç—Ä–∏–º–∞–π—Ç–µ API –∫–ª—é—á –∑ –≤–∞—à–æ–≥–æ Testomat.io –∞–∫–∞—É–Ω—Ç—É
2. –î–æ–¥–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç–∏ –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:
   - `TESTOMATIO` - –≤–∞—à API –∫–ª—é—á Testomat.io
   - `TESTOMATIO_PROJECT_ID` (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ) - ID –ø—Ä–æ–µ–∫—Ç—É

**–Ø–∫ –¥–æ–¥–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏ –≤ GitHub:**
- –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ Settings ‚Üí Secrets and variables ‚Üí Actions
- –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "New repository secret"
- –î–æ–¥–∞–π—Ç–µ `TESTOMATIO` –∑ –≤–∞—à–∏–º API –∫–ª—é—á–µ–º

### 4. –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å—ñ—Ö —Ç–µ—Å—Ç—ñ–≤
npm test

# –ó–∞–ø—É—Å–∫ –∑ UI —Ä–µ–∂–∏–º–æ–º
npm run test:ui

# –ó–∞–ø—É—Å–∫ –≤ headed —Ä–µ–∂–∏–º—ñ (–∑ –±—Ä–∞—É–∑–µ—Ä–æ–º)
npm run test:headed

# –ó–∞–ø—É—Å–∫ –∑ sharding (—Å–∏–º—É–ª—è—Ü—ñ—è CI)
npx playwright test --shard=1/3
npx playwright test --shard=2/3
npx playwright test --shard=3/3
```

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
examplash/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ playwright-sharded-testomat.yml  # GitHub Actions workflow
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îî‚îÄ‚îÄ example.spec.ts                      # –ü—Ä–∏–∫–ª–∞–¥ —Ç–µ—Å—Ç—ñ–≤
‚îú‚îÄ‚îÄ playwright.config.ts                      # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Playwright
‚îú‚îÄ‚îÄ package.json                              # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –ø—Ä–æ–µ–∫—Ç—É
‚îî‚îÄ‚îÄ README.md                                 # –¶—è —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è
```

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### Playwright Config (`playwright.config.ts`)

–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –≤–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ Testomat.io:

- –†–µ–ø–æ—Ä—Ç–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `TESTOMATIO` –∑ environment variables
- –ü—ñ–¥—Ç—Ä–∏–º—É—î sharded –∑–∞–ø—É—Å–∫–∏
- –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ retries —Ç–∞ timeouts –¥–ª—è CI

### GitHub Actions Workflow

Workflow —Ñ–∞–π–ª `.github/workflows/playwright-sharded-testomat.yml` –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è:

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫—É –Ω–∞ push/PR
- ‚úÖ Sharding –∑ 3 –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–º–∏ –¥–∂–æ–±–∞–º–∏ (–º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏)
- ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ Testomat.io
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤ (HTML –∑–≤—ñ—Ç–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—ñ–≤)

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ shards

–©–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å shards, –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `.github/workflows/playwright-sharded-testomat.yml`:

```yaml
matrix:
  shardIndex: [1, 2, 3, 4]  # –ó–±—ñ–ª—å—à—Ç–µ –¥–ª—è –±—ñ–ª—å—à–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ shards
  shardTotal: [4]            # –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –∑–±—ñ–ª—å—à—Ç–µ –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
- 2-3 shards –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç—ñ–≤ (< 100 —Ç–µ—Å—Ç—ñ–≤)
- 4-6 shards –¥–ª—è —Å–µ—Ä–µ–¥–Ω—ñ—Ö –ø—Ä–æ–µ–∫—Ç—ñ–≤ (100-500 —Ç–µ—Å—Ç—ñ–≤)
- 8+ shards –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç—ñ–≤ (> 500 —Ç–µ—Å—Ç—ñ–≤)

## üìä –Ø–∫ –ø—Ä–∞—Ü—é—î Sharding –∑ Testomat.io

1. **GitHub Actions** –∑–∞–ø—É—Å–∫–∞—î –∫—ñ–ª—å–∫–∞ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –¥–∂–æ–±—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 3)
2. –ö–æ–∂–µ–Ω –¥–∂–æ–± –∑–∞–ø—É—Å–∫–∞—î –ø—ñ–¥–º–Ω–æ–∂–∏–Ω—É —Ç–µ—Å—Ç—ñ–≤: `--shard=1/3`, `--shard=2/3`, `--shard=3/3`
3. **Testomat.io —Ä–µ–ø–æ—Ä—Ç–µ—Ä** –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑ –∫–æ–∂–Ω–æ–≥–æ shard
4. **Testomat.io** –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±'—î–¥–Ω—É—î –≤—Å—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ –æ–¥–∏–Ω run (—è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ç–æ–π —Å–∞–º–∏–π `TESTOMATIO_RUN`)

## üß™ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–∏—Ö —Ç–µ—Å—Ç—ñ–≤

–î–æ–¥–∞–π—Ç–µ –Ω–æ–≤—ñ —Ç–µ—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –≤ –ø–∞–ø–∫—É `tests/`:

```typescript
import { test, expect } from '@playwright/test';

test.describe('My Test Suite', () => {
  test('my test', async ({ page }) => {
    await page.goto('https://example.com');
    // –í–∞—à —Ç–µ—Å—Ç –∫–æ–¥ —Ç—É—Ç
  });
});
```

## üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏

### –õ–æ–∫–∞–ª—å–Ω–æ –∑ Testomat.io

```bash
# –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤–∞—à API –∫–ª—é—á
export TESTOMATIO="your-api-key-here"
export TESTOMATIO_RUN="Local Test Run"

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç–∏
npm test
```

### –í CI/CD

1. Push –∫–æ–¥ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å PR
2. GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å workflow
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤:
   - GitHub Actions –≤–∫–ª–∞–¥—Ü—ñ (–¥–ª—è CI —Å—Ç–∞—Ç—É—Å—É)
   - Testomat.io dashboard (–¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤)

## üìù –í–∞–∂–ª–∏–≤—ñ –Ω–æ—Ç–∞—Ç–∫–∏

- **API –∫–ª—é—á**: –ó–∞–≤–∂–¥–∏ –∑–±–µ—Ä—ñ–≥–∞–π—Ç–µ `TESTOMATIO` —è–∫ GitHub Secret, –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∫–æ–º—ñ—Ç—å—Ç–µ –π–æ–≥–æ –≤ –∫–æ–¥
- **Sharding**: Playwright –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—è—î —Ç–µ—Å—Ç–∏ –º—ñ–∂ shards, –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω—ñ—á–æ–≥–æ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏
- **Run name**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π `TESTOMATIO_RUN` –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ CI run, —â–æ–± —Ä–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏ —ó—Ö –≤ Testomat.io
- **Fail-fast**: –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `fail-fast: false`, —â–æ–± –≤—Å—ñ shards –∑–∞–≤–µ—Ä—à–∏–ª–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –æ–¥–∏–Ω –∑ –Ω–∏—Ö –ø–∞–¥–∞—î

## üêõ Troubleshooting

### –¢–µ—Å—Ç–∏ –Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –≤ Testomat.io

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ `TESTOMATIO` —Å–µ–∫—Ä–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –≤ GitHub
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ GitHub Actions –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø–æ–º–∏–ª–æ–∫
3. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ `@testomatio/reporter` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π: `npm list @testomatio/reporter`

### Sharding –Ω–µ –ø—Ä–∞—Ü—é—î –ø—Ä–∞–≤–∏–ª—å–Ω–æ

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: `--shard=1/3`
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ `shardIndex` —Ç–∞ `shardTotal` –≤ –º–∞—Ç—Ä–∏—Ü—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –æ–¥–∏–Ω –æ–¥–Ω–æ–º—É

### –¢–µ—Å—Ç–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –∑–∞–Ω–∞–¥—Ç–æ –¥–æ–≤–≥–æ

1. –ó–±—ñ–ª—å—à—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å shards –≤ workflow –º–∞—Ç—Ä–∏—Ü—ñ
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `workers` –≤ `playwright.config.ts`

## üìö –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

- [Playwright Documentation](https://playwright.dev/)
- [Testomat.io Documentation](https://docs.testomat.io/)
- [GitHub Actions Documentation](https://docs.github.com/en/actions)

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —è–∫ –ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó Playwright –∑ Testomat.io.

